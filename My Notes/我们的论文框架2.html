<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 5.6.2 (450946)"/><meta name="altitude" content="42.58078002929688"/><meta name="author" content="Leask Wong"/><meta name="created" content="2014-04-03 15:26:20 +0000"/><meta name="latitude" content="22.7706193258861"/><meta name="longitude" content="114.2973715084289"/><meta name="updated" content="2014-04-03 15:26:20 +0000"/><title>我们的论文框架2</title></head><body>
<div>1</div>
<div><br/></div>
<div><br/></div>
<div><br/></div>
<div>     3.     公交线路查询系统的实现</div>
<div>4.1 系统的总体设计</div>
<div>4.2 系统核心开发技术</div>
<div>4.2.1 介绍Visual Basic语言</div>
<div>4.2.2介绍Microsoft Access关系数据库</div>
<div>4.2.3 介绍SQL结构化查询语言</div>
<div>介绍完后，说明，你就是采用Microsoft Access关系数据库存储数据，Visual Basic语言高级开发语言来开发的。</div>
<div><br/></div>
<div><br/></div>
<div>4.</div>
<div><br/></div>
<div>4.2.3介绍开发，并附上程序运行结果图。这个部分的开发部分的介绍可以等黄思夏做完后，再写。</div>
<div><br/></div>
<div>3.公交线路查询系统的数据库设计</div>
<div>3.1 数据库设计理论</div>
<div>Access 是微软公司推出的基于Windows的桌面关系数据库管理系统（RDBMS），是Office系列应用软件之一。它提供了表、查询、窗体、报表、页、宏、模块7种用来建立数据库系统的对象；提供了多种向导、生成器、模板，把数据存储、数据查询、界面设计、报表生成等操作规范化；为建立功能完善的数据库管理系统提供了方便，也使得普通用户不必编写代码，就可以完成大部分数据管理的任务。</div>
<div>Access是一种关系型数据库管理系统，其主要特点如下：</div>
<div>3.1.1存储方式单一</div>
<div>Access管理的对象有表、查询、窗体、报表、页、宏和模块，以上对象都存放在后缀为（.mdb）的数据库文件种，便于用户的操作和管理。</div>
<div>3.1.2面向对象</div>
<div>Access是一个面向对象的开发工具，利用面向对象的方式将数据库系统中的各种功能对象化，将数据库管理的各种功能封装在各类对象中。它将一个应用系统当作是由一系列对象组成的，对每个对象它都定义一组方法和属性，以定义该对象的行为和外国，用户还可以按需要给对象扩展方法和属性。通过对象的方法、属性完成数据库的操作和管理，极大地简化了用户的开发工作。同时，这种基于面向对象的开发方式，使得开发应用程序更为简便。</div>
<div>3.1.3 界面友好、易操作</div>
<div>Access是一个可视化工具，是风格与Windows完全一样，用户想要生成对象并应用，只要使用鼠标进行拖放即可，非常直观方便。系统还提供了表生成器、查询生成器、报表设计器以及数据库向导、表向导、查询向导、窗体向导、报表向导等工具，使得操作简便，容易使用和掌握。</div>
<div>3.1.4 集成环境、处理多种数据信息</div>
<div>Access基于Windows操作系统下的集成开发环境，该环境集成了各种向导和生成器工具，极大地提高了开发人员的工作效率，使得建立数据库、创建表、设计用户界面、设计数据查询、报表打印等可以方便有序地进行。</div>
<div>3.1.5 Access支持ODBC（开发数据库互连，Open Data Base Connectivity），利用Access强大的DDE（动态数据交换）和OLE（对象的联接和嵌入）特性，可以在一个数据表中嵌入位图、声音、Excel表格、Word文档，还可以建立动态的数据库报表和窗体等。Access还可以将程序应用于网络，并与网络上的动态数据相联接。利用数据库访问页对象生成HTML文件，轻松构建Internet/Intranet的应用。</div>
<div><br/></div>
<div>3.2 公交线路查询系统的数据库分析</div>
<div>分析众多的深圳公交车线路查询系统后，我们发现这么多的查询系统当中不是缺乏地图显示的就是，线路信息不准确的，或者是查询界面不直观的，或者是查询速度不理想等一些不足的地方，我们开发了一个信息准确操作直观简单并且有地图显示的系统。</div>
<div>作为一个公交车线路查询系统，数据库当然要包括与公交车有关的种种信息，包括，线路名称、公交车所经过的站点（为了简化实现，可以将往返线路作为两条单独的线路进行存储 ，如20路公交车分别以2来行、2去行加以区别而存储。虽然这样增加了数据量，但是可以简化各种问题。如：换乘当中计算线路路程时会有很明显的效果。），为了能支持计算最短线路路程，而系统对数据库采用地图“点”化，也就是说对公交车线路所经过的路线都以点的形式储存。这样的储存方式不单单有利于计算最短线路，而且还能在地图上给用户显示乘坐的线路。上面有提到查询速度不理想，我们采用缓存的技术来对用户的操作进行储存，如：用户查询从东门到紫薇花园的公交车线路查询，系统会先查询用户的缓存，匹配起点站和终点站，如果能在缓存上匹配上的化就马上给用户输出有关的全部信息，这能提高换乘查询的速度。缓存的数据库是根据用户的使用而不断积累的，当该数据库量足够大的时候，换乘查询就会想查询直达车一样，在跟着的章节会详细介绍。</div>
<div><br/></div>
<div>3.3 公交线路查询系统的数据库设计</div>
<div>根据系统需要我们总共设计了四个表，具体有Line_Info、Locations_Info、Stations_Info和Temp_Shed四个数据库。</div>
<div>3.2.1 Line_Info：这是公交线路的数据库，里面包含有公交线路号数，起始站点，终点站点，所属汽车公司，所经过的站点等一些有关线路的信息。</div>
<div>字段名称</div>
<div><br/></div>
<div>数据类型</div>
<div><br/></div>
<div>描述</div>
<div>Line_Num</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>公交线路名称</div>
<div>Terminal_Begin</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>起始站点</div>
<div>Terminal_End</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>终点站点</div>
<div>Stations_Up_Going</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>上行的站点</div>
<div>Stations_Down_Going</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>下行的站点</div>
<div>Company</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>所属公车公司</div>
<div>Path_ICED</div>
<div><br/></div>
<div>是 /否</div>
<div><br/></div>
<div>线路显示</div>
<div>Path_Up_Going</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>上行站点拐点坐标</div>
<div>Path_Down_Going</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>下行站点拐点坐标</div>
<div>Roads_Up_Going</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>上行经过的道路</div>
<div>Roads_Down_Going</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>下行经过的道路</div>
<div>现在的城市公交车线路是非常复杂的，就算是同一条线路上行与下行所经过的站点都会有出入，所以我们采取了上行和下行对公交路线进行储存，虽然为数数据库录入工作带来额外负担，但能为用户提供准确的信息的同时方便系统进行最短线路的计算，等很多方面的有点。我们用了英语输入法下的“&gt;”符号进行对数据库站点间的分隔。</div>
<div>3.2.2 Locations_Info：里面包含的数据是地方的相对位置，在该系统的地图上用相对坐标来定位相对位置。</div>
<div>字段名称</div>
<div><br/></div>
<div>数据类型</div>
<div><br/></div>
<div>描述</div>
<div>Location</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>地点名称</div>
<div>Position_X</div>
<div><br/></div>
<div>数字</div>
<div><br/></div>
<div>相对X坐标</div>
<div>Position_Y</div>
<div><br/></div>
<div>数字</div>
<div><br/></div>
<div>相对Y坐标</div>
<div>Information</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>预留给商家的广告信息项目</div>
<div>Image</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>建筑物的图</div>
<div>该系统的地图是从百度地图上截取下来然后整合到客户端里面的，我们进行地点定位的时候采用相对坐标能方便开发者的工作，在用户客户端里面显示的是经过计算转换的实际经纬度。</div>
<div>开发此数据库的主要目的是为商家预备的，预期效果有用户可以查询公交站点后，系统自动提示在该站点附近有那些商店，或者是搜索商店名后系统计算距离目标事物最近的公交车站点。从而方便用户上下车的准备，还有就是给旅游人士的出行带来充足的准备或者计划。</div>
<div>3.2.3 Stations_Info：储存的是站点在地图上的相对坐标的信息，同上面一样采用的是相对位置的方式来保存信息。</div>
<div>字段名称</div>
<div><br/></div>
<div>数据类型</div>
<div><br/></div>
<div>描述</div>
<div>Station_Name</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>站点名称</div>
<div>Position_X</div>
<div><br/></div>
<div>数字</div>
<div><br/></div>
<div>相对X坐标</div>
<div>Position_Y</div>
<div><br/></div>
<div>数字</div>
<div><br/></div>
<div>相对Y坐标</div>
<div>开发此数据库的目标有两个，其中一个和3.2.2有关联，上面提到的“开发此数据库的主要目的是为商家预备的，……后系统计算距离目标事物最近的公交车站点。”这个数据库的站点坐标主要是为计算商店与站点之间的最短距离而准备的，也.是为商家准备的。另一个目标是，把站点坐标独立出来还有利于在用户进行模糊查询时系统运行的速度，例如：用户输入“紫薇”时，系统就不必搜索所有公交车线路的所有站点，就能马上在备选栏下显示“紫薇花园、紫薇步行街、紫薇阁、紫薇花园步行街”，能提高用户的查询效率。</div>
<div><br/></div>
<div>3.2.4 Temp_Shed:保存的是客户端的使用缓存。</div>
<div>St_A</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>查询的起点站</div>
<div>St_B</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>查询的终点站</div>
<div>Line_CH</div>
<div><br/></div>
<div>是 /否</div>
<div><br/></div>
<div>是否有换乘</div>
<div>Line_A</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>换乘前的线路</div>
<div>Line_B</div>
<div><br/></div>
<div>文本</div>
<div><br/></div>
<div>换乘后的线路</div>
<div>Line_A_Sts</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>换乘前经过的站点</div>
<div>Line_B_Sts</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>换乘后经过的站点</div>
<div>Line_A_Path</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>换乘前的线路坐标</div>
<div>Line_B_Path</div>
<div><br/></div>
<div>备注</div>
<div><br/></div>
<div>换乘后的线路坐标</div>
<div>Line_Long</div>
<div><br/></div>
<div>数字</div>
<div><br/></div>
<div>总的乘坐里程</div>
<div><br/></div>
<div><br/></div>
<div>3.3.1概念结构设计</div>
<div>得到E—R图</div>
<div>3.3.2 逻辑结构设计</div>
<div>得到表结构</div>
<div>3.4 小结</div>
</body></html>